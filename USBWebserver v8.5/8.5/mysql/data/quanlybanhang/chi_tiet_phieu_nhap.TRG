TYPE=TRIGGERS
triggers='CREATE DEFINER=`root`@`localhost` TRIGGER `after_insert_chi_tiet_phieu_nhap` AFTER INSERT ON `chi_tiet_phieu_nhap` \n    FOR EACH ROW \nBEGIN\n	INSERT INTO chi_tiet_ton_kho(MA_PHIEU_NHAP, MA_HANG_HOA, STT_CHI_TIET_PHIEU_NHAP, SO_LUONG_TON_KHO)\n		VALUES(new.MA_PHIEU_NHAP, new.MA_HANG_HOA, new.STT_CHI_TIET_PHIEU_NHAP, new.SO_LUONG_NHAP);\n			\n	INSERT INTO chi_tiet_xnt_hien_tai(MA_KHO_HANG, XNTHT_NGAY, MA_PHIEU_NHAP, MA_HANG_HOA, STT_CHI_TIET_PHIEU_NHAP, XNTHT_STT, XNTHT_SO_LUONG_TON, XNTHT_SO_LUONG_NHAP, XNTHT_SO_LUONG_XUAT)\n		SELECT MA_KHO_HANG,\n			DATE(THOI_GIAN_TAO_PHIEU_NHAP) AS XNTHT_NGAY,\n			MA_PHIEU_NHAP,\n			new.MA_HANG_HOA,\n			new.STT_CHI_TIET_PHIEU_NHAP,\n			(SELECT IFNULL(MAX(XNTHT_STT), 0) + 1 FROM chi_tiet_xnt_hien_tai WHERE MA_KHO_HANG = pn.MA_KHO_HANG AND XNTHT_NGAY = DATE(THOI_GIAN_TAO_PHIEU_NHAP)) AS XNTHT_STT,\n			0 AS XNTHT_SO_LUONG_TON, \n			new.SO_LUONG_NHAP AS XNTHT_SO_LUONG_NHAP,\n			0 AS XNTHT_SO_LUONG_XUAT \n		FROM phieu_nhap pn\n		WHERE MA_PHIEU_NHAP = new.MA_PHIEU_NHAP;	\nEND' 'CREATE DEFINER=`root`@`localhost` TRIGGER `before_delete_chi_tiet_phieu_nhap` BEFORE DELETE ON `chi_tiet_phieu_nhap` \n    FOR EACH ROW \nBEGIN\n	DELETE FROM chi_tiet_ton_kho\n	WHERE MA_PHIEU_NHAP = OLD.MA_PHIEU_NHAP\n		AND `MA_HANG_HOA` = OLD.MA_HANG_HOA\n		AND `STT_CHI_TIET_PHIEU_NHAP` = OLD.STT_CHI_TIET_PHIEU_NHAP;\n		\n	DELETE FROM chi_tiet_xnt_hien_tai\n	WHERE `MA_PHIEU_NHAP` = OLD.MA_PHIEU_NHAP\n		AND `STT_CHI_TIET_PHIEU_NHAP` = OLD.MA_PHIEU_NHAP\n		AND `MA_HANG_HOA` = OLD.MA_PHIEU_NHAP;\nEND'
sql_modes=0 0
definers='root@localhost' 'root@localhost'
client_cs_names='utf8' 'utf8'
connection_cl_names='utf8_general_ci' 'utf8_general_ci'
db_cl_names='utf8_general_ci' 'utf8_general_ci'
